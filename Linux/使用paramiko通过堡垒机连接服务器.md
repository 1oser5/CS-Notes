## 原因
公司需要连接远程服务器进行前后端项目的一些配置，前后端可能会配置在不同的服务器上，并且这些服务器都只能通过堡垒机连接，而且流程很繁琐，所以提出能否使用自动化方案来解决手动进行堡垒机连接，账户密码输入的相关，文件传输固定步骤

## 方案
在刚开始拿到这个需求的时候有点懵逼，因为以前没接触过类似的东西，让我不知道怎么下手，在同事的演示下我感觉连接堡垒机的步骤和我之前尝试过的调用远程仓库有点不一样，一下子不知道怎么写了。在我导师的开导下，事实上发现其实底层协议是一样的，只要关注其底层协议，并且使用对应的方法将就可以实现连接

## 过程

在过程中主要遇到两个问题，第一个是在远程执行命令的时候，会反馈 
```python
segmentation fault
```
这个问题我在网上也找不到任何解答，最后在翻阅别人写的博客的时候，发现类似的需求，是使用 Paramiko 的 channel 连接的，并且一个非常重要的点是要进行休眠，给堡垒机一段时间去连接真机。并且命令的最后需要加上 回车才会执行，这些都是一些细节问题。

在传输文件的时候，刚开始就测试传输文件夹，发现报错，我以为是堡垒机的问题，想到能不能先传输到中继机器，在传输到真实机器的方案，但是这样也不行。最后发现是协议的问题。因为我在定义传输文件夹时，paramiko没有类似的功能，其只能传输单个文件，因此我封装的传输文件夹的库分为三步，第一，获得本地文件夹树状结构，第二，在远程服务器对应位置创建相应文件夹结构，第三，向对应文件夹传输对应文件。但是这次的堡垒机连接，传输文件的密码和运行命令的密码不同，因此需要进行分开实现。