## ASCII 码

计算机中所有的信息最终都是一个二进制值，每一个二进制有 `0` 和 `1` 两种状态。八个二进制可以有 256 种状态，这被称为一个字节。

上世纪 60 年代，美国制定了一套英文字符和二进制的对应关系，这被称为 `ASCII` 码。

`ASCII` 规定了 `128` 个字符的编码，所以只占用了一个字节的 `7` 位，因此统一规定所有 `ASCII` 码的首位都为 `0`。

## 非 ACSII 编码

英语用 128 个字符表示就足够了，但是别的语言不行。比如法语，字母上方有音标注释，就无法用 `ASCII` 码来表示了。因此欧洲部分国家都采用 `8` 位的编码体系。

虽然有些国家都是要 256 符号的编码体系，但是不同的国家是又不一样的字母，所以很大程度上这些编码中，同一编码表示的是不同的字符。

亚洲地区的文字符号就更多了，汉字多达 `10` 万左右，需要使用多个字节来表达一个符号，常见的简体中文编码就是 `GB2312`，使用两个字节表示一个汉字，总共可以表示 `256x256` 个字符。


## Unicode 

上文说到世界上有这么多编码，那么同一个编码可能表示的是不同的字符。因此要打开一个文本文件，必须知道他的编码，不然就容易出现乱码情况。

但是这样太麻烦了，所有出现了一种吧世界上所有符号都纳入其中，每个符号赋予独一无二编码的东西，就是 `Unicode`

## Unicode的问题

`Unicode` 是一个符号集，他只规定了二进制的编码，但他没有规定如何存储。那么问题就来了，有些字符只需要一个字节，而有些比如汉字 `严` 需要两个字节，更有甚者需要三个到四个字节才能表示。

如果所有的字符都规定字节长度，就导致大量冗余，但是不规定字节长度，那计算机如何才能得知这个字符是占用了一个字节还是两个字节呢？

这个问题导致了 `Unicode` 在很长一段时间内无法推广。

## UTF-8

`UTF-8` 是目前互联网中使用最广的 `Unicode` 实现方式。

`UTF-8` 最大的特点是其采用不固定长的编码方式，其可以使用 1-4 个字节表示一个符号，根据不同符号变化字节长度。

`UTF-8` 的编码规则很简单，只有两条：

+ 单子节的字符，首位都为 `0`，因此单字节 `ASCII` 码和 `UTF-8` 编码是一致的。
+ 对于 `n` 字节的字符(n > 1),首字节的前 `n` 为都为0,后面字符的前两位都为 `10`。剩下未被提及的二进制位，全都是这个符号的 `Unicode` 码。

|Unicode符号范围     |        UTF-8编码方式|
|--|--|
|(十六进制)        |              （二进制）|
0000 0000-0000 007F | 0xxxxxxx
0000 0080-0000 07FF | 110xxxxx 10xxxxxx
0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx
0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx


下面，还是以汉字`严`为例，演示如何实现 `UTF-8` 编码。

`严` 的 `Unicode` 是 `4E25（100111000100101）`，根据上表，可以发现 `4E25` 处在第三行的范围内 `（0000 0800 - 0000 FFFF）` ，因此 `严 `的 `UTF-8` 编码需要三个字节，即格式是 `1110xxxx 10xxxxxx 10xxxxxx` 。然后，从严的最后一个二进制位开始，依次从后向前填入格式中的x，多出的位补0。这样就得到了，严的 `UTF-8` 编码是 `11100100 1011100010100101` ，转换成十六进制就是 `E4B8A5`。

因此 `UTF-8` 和 `Unicode` 编码是不同的。

## Little endian 和 Big endian

以汉字 `严` 为例，`严` 的 `Unicode` 编码是 `4E25`，需要两个字节存储，一个字节是 `4E`，一个字节是 `25`。

存储的时候，`4E` 在前，`25` 在后，就是 Big endian 方式，如果 `25` 在前，`4E` 在后，那么就是 Little endian 方式。

这两个古怪的名称来自英国作家斯威夫特的《格列佛游记》。在该书中，小人国里爆发了内战，战争起因是人们争论，吃鸡蛋时究竟是从大头(Big-endian)敲开还是从小头(Little-endian)敲开。为了这件事情，前后爆发了六次战争，一个皇帝送了命，另一个皇帝丢了王位。

很自然的，计算机如何得知该文件采用哪种方式编码呢？

`Unicode` 规范定义，每一个文件的最前面分别加入一个表示编码顺序的字符，这个字符的名字叫做`零宽度非换行空格（zero width no-break space）`，用 `FEFF` 表示。这正好是两个字节，而且 `FF` 比 `FE` 大1。

如果一个文本文件的头两个字节是 `FE` `FF`，就表示该文件采用大头方式；如果头两个字节是 `FF` `FE`，就表示该文件采用小头方式。

