# GPS定位原理

> 原文链接 <https://blog.digitalbunker.dev/2020/08/28/how-do-global-positioning-systems-gps-work/>

## 背景知识

全局定位系统(Global Positioning System),最初被叫做NavStar，由美军于1995年创造。NavStar最初是在地球同步轨道上十二颗GPS卫星的集合。

如今，NavStar 已经成长为在地球表面大约一万三千英里的超过三十颗卫星组成的网络。这些卫星在从西向东环游中会通过同一个地点两次。

尽管其他国家在发展他们自己的GPS卫星网络，但是美国 NavStar 系统仍然是标准。

只需要 24 颗卫星就能够保证视线覆盖超过 95% 的地球表面。剩下的主要最为后备或者在需要更高精度时被使用。

## 卫星

这些卫星上最关键的组件是**原子钟**。如你所见，可靠的计时是卫星最重要的功能。

> 原子钟被设计用于测量一秒的精确长度，是现代计时的主要单元。国际单元制（SI）定义一秒为铯-133院子在精确状态下震荡所需要的时间：90亿。

### GPS 有效负荷

GPS本质上是一个被动系统，GPS卫星不接受任何信息。

换而言之，每个卫星以规定间隔报告。

1. 伪随机码：卫星的标识值，接收器用其进行信号解码。
2. 年历数据：在任何给定时间的卫星位置信息和其他存活卫星的环绕信息，这些信息告知了接收器在何时哪些卫星应该被激活，帮助接收器快速获取GPS定位。
3. 星历数据：更特殊的卫星信息：当前日期，时间，健康和位置信息。这些数据大概每三十秒播广播一次。星历数据通常每两小时更新一次，有效期为4小时。

## 冷启动

尽管广播十分频繁，单独的年历数据通常不足以使GPS接收器获得定位信息，尤其是GPS接收器从冷启动启动时。

多数情况下不是，GPS接收器的缓存年历信息将会过期，因此有些接收器，尤其是老式的，可能必须等待超过10分钟以上来接受从每个卫星广播的全部年历和星历信息，然后才能提供GPS定位。

另外，星历数据会自然过期，由于时钟漂移而无法缓存太久。等待广播和接受已更新的星历数据是GPS接收器长启动时间的主要消耗。

## 辅助全球定位系统

幸运的是大多现代设备，比如智能手机，更够最小化等待时间。大多数现代移动设备使用传统GPS技术的变种，被称为 辅助全球定位系统(Assisted Global Positioning System)，帮助他们快速获得GPS定位。

A-GPS 通过手机的数据连接与帮助服务器进行联系。该服务器保证了年历和星历数据正确，所以手机不需要等待卫星传播数据。无论如何，一旦你超出了覆盖区域，手机将回退到运行GPS单元，并且需要几分钟来以传统方式获得星历和年历信息。

## GPS信号

大多数GPS传输位于 UHF 波频。大多民用GPS传输在  1575.42 MHz 或者 1227.60 MHz。

另外，GPS信号使用 CDMA扩频技术来保证运行所有卫星无干扰的以相同频率发送信息。

## GPS传播

根据无线电子，标准GPS传输长度约为15000比特，传输速率为50比特/秒，大概需要30秒来完成传输。

该帧呗分割成长度为300比特，传输时间为6秒的5个子帧。

分片帮助接收器识别传输的开头和结尾，因此接收器可以轻松同步信息和解码。

1. 分片1：时钟，GPS时间，卫星健康信息，卫星ID
2. 分片2-3：星历信息
3. 分片4-5：年历信息

## 接收器

### 三边测量

GPS，在接收器端，通过叫做三边测量的方法工作。

想象一下我告诉你我离洛杉矶150英里，距离拉斯维加斯200英里，距离弗朗西斯70英里。

通过三个坐标值，你能够确定一个满足这些约束的区域并且在该区域中估计我的位置。你拥有越高的测量精度，则能更加精确的获得我的位置。

GPS最少需要三颗卫星来获得你的定位。我们已知，GPS信号包括卫星的位置信息和取决于卫星内部时钟的时间。如果我们测量我们接收到数据的时间并且比较从卫星发送时间到接受时间的时间差。我们能计算出信息在途中花费了多久。例外，得知所有信号都以光速传播，我们可以将俩个值乘起来计算出你和对应卫星的直线距离。

为此卫星使用非常昂贵的原子钟。中途传输时间越精确，则接收器获得的卫星距离信息越精确。

尽管我们通过三个卫星计算出了用户的2D位置，但是使用四颗卫星能让我们计算出高度值。2D坐标定位在你位于海平面附近还是有效的。如果你在某座山上，2D定位会产生几百米的错误。

此外，因为接收器，比如智能手机，通常有较为便宜的时钟，我们需要计算由便宜硬件和其他环境因素导致的时间计算错误，比如由于电离层和对流层硬气点信号速度降低。使用四颗卫星不仅仅提供了搞得信息，还可以使我们求解方程组，使我们可以识别时钟误差并计算出更准确的位置。

大多数现代卫星接收器使用格外信息来常识将其内部时钟和卫星原子钟进行同步。

这就是为什么大多现代卫星接收器通常将会追踪所有可用可视卫星，但只有一些子集来进行计算。

如今GPS接收器天线可以接受最少4颗卫星，可以精确的计算出三维坐标。

